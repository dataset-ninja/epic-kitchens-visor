The authors unveiled the **EPIC-KITCHENS VISOR: VIdeo Segmentations and Object Relations**, a novel dataset featuring pixel annotations and a benchmark suite tailored for segmenting hands and dynamic objects in egocentric video footage. VISOR introduces an innovative annotation pipeline, incorporating AI-powered elements for enhanced scalability and annotation quality. In total, the authors have made publicly available 272,000 manually annotated semantic masks encompassing 257 object classes, along with 9.9 million interpolated dense masks and 67,000 hand-object relations. This comprehensive dataset covers 36 hours of untrimmed video footage spanning 179 sequences.

## Motivation

Consider a video capturing the tedious process of preparing bread, from obtaining, measuring and mixing ingredients to kneading and shaping dough. Despite being a routine task, the discrete nature of computer vision models, trained mostly from images, expects to recognise objects as either flour or dough. Capturing the transformation through pixel-level annotations has not been attempted to date. VISOR incorporates action labels and offers sparse segmentations of both hands and dynamic objects. The annotation rate is designed to represent a wide range of temporal actions, encompassing both short actions (e.g., 'add salt') and longer actions (e.g., 'knead dough'). Rich pixel-level annotations have revolutionized tasks such as image understanding and autonomous driving. By integrating action labels with semantic segmentations, the authors aim to empower advanced video comprehension capabilities. Previous attempts to incorporate spatio-temporal annotations and object relations have typically relied on bounding boxes. While some pioneering video datasets provide pixel labels over time, they are often limited in duration and lack fine-grained action labels.

<img src="https://github.com/dataset-ninja/epic-kitchens-visor/assets/120389559/310100a2-5fa9-429a-b471-1c5f69d2e392" alt="image" width="1000">

<span style="font-size: smaller; font-style: italic;">VISOR Annotations and Benchmarks. Sparse segmentations from one video (P06_03), where flour turns into dough over the course of over 11 minutes. The colours of the timeline represent the stages: flour→mixture→dough. By building off of the EPIC-KITCHENS dataset, the segments join a rich set of action labels.</span>

## Dataset description

The authors' annotation pipeline comprises several stages. Initially, they identify the frames and active entities earmarked for annotation. Once determined, they proceed to obtain pixel-level annotations, significantly expedited through the use of an AI-powered tool. To ensure uniformity, annotators undergo extensive training and their work is meticulously verified manually. Additionally, the authors gather supplementary annotations essential for their challenges. Their efforts are based on the extensive egocentric EPIC-KITCHENS-100 dataset, collected under University of Bristol faculty ethics approval and participants' signed consent (anonymized). Participants wear head-mounted cameras, initiating recording upon entering the kitchen and concluding when they exit. These recordings feature fine-grained action labels, including video file identification, action start and end times, succinct open-vocabulary action descriptions (e.g., 'take mozzarella out of packet'), and closed-vocabulary verb and noun classifications (e.g., categorizing 'mozzarella' as 'cheese').

|           | Train | Val  | Train+Val | Test | Total  |
|-----------|-------|------|-----------|------|--------|
| Kitchens  | 33    | 24 (5 unseen) | 38  | 13 (4 unseen) | 42     |
| Untrimmed Videos | 115 | 43   | 158       | 21   | 179    |
| Images (and %) | 32,857 (64.8%) | 7,747 (15.3%) | 40,604 (80.0%) | 10,125 (20.0%) | 50,729 |
| Masks (and %) | 174,426 (64.2%) | 41,559 (15.3%) | 215,985 (79.5%) | 55,599 (20.5%) | 271,584 |
| Entity Classes | 242 | 182 (9 zero-shot) | 251 | 160 (6 zero-shot) | 257 |

<span style="font-size: smaller; font-style: italic;">VISOR splits statistics.</span>

The initial stage of the authors' process is dedicated to determining which data and entities necessitate annotation. Their data selection process focuses on identifying clear frames suitable for annotation and ensuring a balanced distribution of annotations across actions rather than time intervals, thus encompassing actions of varying durations. Regarding entity selection, the goal is to identify all active objects pertinent to the action, including tools, utensils, and appliances. This step is crucial as the narrations accompanying the videos may not explicitly mention objects implied by common sense, and the objects involved can vary from one sample to another. For instance, the action 'peel carrot' may involve a peeler and a bowl in one instance, while in another, a knife and chopping board may be used. It's important to note that since the videos are filmed in domestic settings, frames may contain a high degree of clutter with background or irrelevant objects that do not require segmentation. The authors segment the untrimmed videos into sequences, each comprising three non-overlapping actions. This results in an average of 12 seconds of temporally consistent annotations. The choice of three actions was deliberate, aiming to introduce a moderate yet meaningful challenge compared to previous video segmentation datasets, which typically feature shorter sequence lengths ranging from 3 to 5 seconds. In each sequence, they annotate six frames, prioritizing clear frames to ensure better object delineation and avoiding blurred frames whenever feasible. To identify active entities for annotation, the authors employ a multi-step approach. They parse nouns from the narrations, correlate them with actions extracted from parsed verbs (e.g., matching 'cut' with 'knife'), and incorporate manual annotations. From this comprehensive list, annotators then select the entities present in each frame.

<img src="https://github.com/dataset-ninja/epic-kitchens-visor/assets/120389559/c752e0f4-1776-4de7-ba13-1049ced69a8f" alt="image" width="1000">

<span style="font-size: smaller; font-style: italic;">Part of the VISOR Annotation Pipeline. The authors divide untrimmed videos to subsequences of 3 consecutive actions, sampling 6 frames/seq. We find entities to annotate via the union of automatic parsing of narrations, manual rules, and human annotations. These are then manually segmented.</span>

During the project’s 22 months, the authors worked closely with 13 annotators: training, answering questions, and revising their annotations. To reduce the cost of pixel-level annotation, they used [TORonto Annotation Suite](https://aidemos.cs.toronto.edu/toras), which uses interactive tools built from variants of the interface combines a mix of manual and AI-enhanced tools that dramatically improve the speed of obtaining accurate annotations. The AI models were trained on generic segmentation datasets like [ADE-20K](https://groups.csail.mit.edu/vision/datasets/ADE20K/). The authors engaged freelance annotators who were provided with a comprehensive project overview, underwent training sessions on the annotation tool, and received a glossary of objects. They established guidelines to ensure uniform segmentations across frames, particularly regarding containers, packaging, transparency, and occlusion. For instance, a rule was implemented for 'containers' wherein inactive objects within cupboards were not segmented to maintain the integrity of the cupboard's context. To maintain temporal consistency, each video was annotated by a single annotator. Furthermore, manual verification was conducted for each video, actively addressing any annotator uncertainties. An interface was developed to facilitate rapid correction of annotations, with a specific emphasis on preserving temporal coherence.

<img src="https://github.com/dataset-ninja/epic-kitchens-visor/assets/120389559/b97c4805-a0e2-4a6d-a261-c9f47b7d017d" alt="image" width="1000">

<span style="font-size: smaller; font-style: italic;">Segmentations from VISOR with entity names (legend) and ongoing action (above).</span>

EPIC-KITCHENS-100 encompasses 300 noun classes, which categorize open-vocabulary entity names. Among these, VISOR segmentations encompass 252 classes observed within the annotated 36-hour dataset. VISOR also introduces 263 new entities spanning across 83 noun classes. To integrate these new entities seamlessly, they were manually re-clustered into the existing 300 EPIC-KITCHENS classes. These additional entities primarily consist of objects commonly manipulated in daily activities but not explicitly mentioned in narrations. For example, entities like 'coffee package' are grouped under the 'package' class. Additionally, five new classes were introduced, including *left:hand*, *right:hand* (previously grouped under 'hand'), *left:glove*, *right:glove* (previously under 'glove'), and *foot*. The activities captured in VISOR primarily revolve around hands interacting with the surroundings. To enhance the dataset's utility, the authors augment each hand segmentation by incorporating contact information, indicating whether the hand is in contact with any object and, if so, which segment it is best described as contacting. Candidate segments are identified as those bordering the hand, from which human annotators make selections. Alternatively, annotators may identify the hand with ***in contact*** tag: "not in physical contact" with any object or choose "none of the above" for occluded hands. In cases where a consensus cannot be reached among annotators, the authors mark these instances as inconclusive. During training and evaluation, hands annotated with "none of the above" or deemed inconclusive are disregarded. In certain kitchen scenarios, hands may be obscured by gloves, such as during washing, cleaning, or handling hot surfaces with oven mitts. Consequently, the authors also annotate gloves to identify instances where they are worn on the hand. These gloves are further annotated along with their relations to active objects, mirroring the process applied to visible hands. Both hands and on-hand gloves are considered as acting hands for all relevant benchmarks.

**Note:** More information about the correspondence of actions to frames in the dataset can be downloaded from the [link](https://github.com/epic-kitchens/epic-kitchens-100-annotations).

